<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>List Users and Filter</title>
  </head>
  <body>
    <h1>List Users and Filter</h1>
    <button id="loadBtn">Load Users</button>
    <input type="text" id="filterInput" placeholder="Filter by name..." />
    <p id="resMsg"></p>
    <script>
      let users = [];
      const resMsg = document.getElementById("resMsg");
      const filterInput = document.getElementById("filterInput");

      document.querySelector("button").addEventListener("click", async () => {
        resMsg.innerText = "Loading...";
        try {
          const response = await fetch(
            "https://jsonplaceholder.typicode.com/users"
          );
          users = await response.json();
          displayUsers(users);
        } catch (err) {
          console.log(err);
          resMsg.innerText = "Error loading users.";
        }
      });

      filterInput.addEventListener("input", () => {
        const filterText = filterInput.value.toLowerCase();
        const filteredUsers = users.filter((user) =>
          user.name.toLowerCase().includes(filterText)
        );
        if (filteredUsers.length === 0) {
          resMsg.innerText = "No users found!";
        } else {
          displayUsers(filteredUsers);
        }
      });

      function displayUsers(data) {
        resMsg.innerHTML = "";
        for (let i = 0; i < data.length; i++) {
          resMsg.innerHTML += `
            <b>${data[i].name}</b><br/>
            Email: ${data[i].email}<br/>
            City: ${data[i].address.city}<br/>
            <br/>
          `;
        }
      }
    </script>
  </body>
</html>
